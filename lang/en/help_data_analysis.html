<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>Questionnaire New Features HELP</title>
<style type="text/css">
<!--
.questiontable {
	border-collapse:collapse;
	margin-top:5px;
	margin-bottom:5px;
}
.questiontable td{
	border:#999999 thin dashed;
	padding:5px;
}
.Style1 {
	color: #0000FF;
	font-weight: bold;
}
-->
</style>
</head>

<body style=" font-family:Verdana, Arial, Helvetica, sans-serif; font-size:small;">
<h3>The Data Analysis feature</h3>
<h4>Case study #1: Personality test</h4>
<h5>Sample questionnaire: <em>Human resource department (Fun Test)</em></h5>
<ol>
  <li>Create questionnaire as usual.</li>
  <li>Go to the <strong>Advanced Settings</strong> tab. </li>
  <li>In Submission options go to <strong>Data Analysis</strong> and select <strong>Total Score</strong> from the dropdown list. Save settings.</li>
  <li>Start creating your questions. In the Add selected question type dropdown list you notice that the list of question types available has been reduced to 4:
    <ol style="list-style: circle">
      <li>Dropdown box</li>
      <li>Label </li>
      <li>Radio Buttons</li>
      <li>Rate (scale 1..5) <br />
      The Data Analysis feature can only be applied to questions with multiple choice and single answer such as the radio buttons (or dropdown box) and the Rate/Scale types. </li>
    </ol>
  </li>
  <li>For each &quot;possible answer&quot; you must give a value or score as in this example:
    <br />
    <table  class="questiontable">
      <tr>
        <td valign="top">Question text </td>
        <td>When do you feel your best? </td>
      </tr>
      <tr>
        <td valign="top">Possible answers </td>
        <td>2=In the morning<br />
4=During the afternoon and early evening<br />
6=Late at night</td>
      </tr>
    </table>
  Accepted values are integer numbers, including 0 and not greater than 99. Each &quot;possible answer&quot; line starts with a value, immediately followed by the equal sign (=), immediately followed by the possible answer text. The values corresponding to the respondent's choices will be added up to make their &quot;total score&quot; for the questionnaire.</li>
  <li>For questions where possible answers can be aligned along a scale, it is recommended to use the Rate/Scale question type rather than the Radio buttons type. For example (in the <em>Pretest for Attitudes Toward Computers in Healthcare</em>):<br />
      <table class="questiontable">
        <tr>
          <td><em>Question text</em></td>
          <td>The computer is a powerful enabling tool.</td>
        </tr>
        <tr>
          <td valign="top"><em>Possible answers</em></td>
          <td>4=Agree Strongly<br />
3=Agree<br />
2=Not certain<br />
1=Disagree<br />
0=Disagree Strongly </td>
        </tr>
      </table>
  </li>
  <li>You <em>may</em> mix questions of different types but this is not recommended. It is better for the general look of your questionnaire to stick to the same question type throughout.</li>
  <li>When done with questions creating, go again to the <strong>Advanced Settings</strong> tab to edit the <strong>Data Analysis Heading text</strong> and <strong>Body text</strong>. The Heading text will be displayed at the top of the respondent's responses. Enter a fairly brief descriptive heading there.</li>
  <li>The <strong>Data Analysis Body text</strong> field is where you will enter the various Calculations, Conditions and Messages to be displayed to the Respondent. You'll have to be very careful to follow the examples given in this Help file, otherwise you will get error messages or unwanted displays.</li>
  <li>In <em><strong>Total Score </strong></em><strong>Data Analysis</strong> mode you do not have to enter any calculation formula; the maximum total score and the respondent's total score will be calculated automatically. You can use the following 3 variables in your conditions and messages: $totalscore, $maxtotalscore and $totalscorepercent. Let's examine the beginning of the <strong>Data Analysis Body text</strong> field of our sample questionnaire:<br />
  
    <table width="100%" height="210"  style="border:#999999 thin dashed; margin-top:5px; margin-bottom:5px;">
      <tr>
        <td valign="top">line</td>
        <td valign="top">&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">1</td>
        <td>You scored $totalscorepercent%.</td>
      </tr>
      <tr>
        <td valign="top">2</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">3</td>
        <td> if ($totalscore &gt; 60)</td>
      </tr>
      <tr>
        <td valign="top">4</td>
        <td>Others see you as someone they should &quot;handle with care&quot; You're seen as vain, self-centered, and who is extremely dominant. Others may admire you, wishing they could be more like you, but don't always trust you, hesitating to become too deeply involved with you.</td>
      </tr>
      <tr>
        <td valign="top">5</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">6</td>
        <td>if ($totalscore &lt; 61 and $totalscore &gt; 50)</td>
      </tr>
      <tr>
        <td valign="top">7</td>
        <td>Others see you as an exciting, highly volatile, rather impulsive personality; a natural leader, who's quick to make decisions, though not always the right ones. They see you as bold and adventuresome, someone who will try anything once; someone who takes chances and enjoys an adventure. They enjoy being in your company because of the excitement you radiate.</td>
      </tr>
    </table>
  </li>
  <li>Description of these sample lines.
    <ol style="list-style:lower-alpha">
      <li>The wording of line 1 is totally free. You will generally use it to display the respondent's total score. Note that the $totalscorepercent variable is an integer (rounded) number. You need to add the % character at the end if you want it displayed. On that same line, we might have added something like: &quot;You got $totalscore out of $maxtotalscore&quot;. </li>
      <li>Note that the <strong>Data Analysis Body text</strong> field is a plain text editor, with no formatting facilities. If you know what you are doing, you <em>may </em>add HTML tags, e.g. &lt;em&gt;&lt;/em&gt; for italics, etc. But please use sparingly.</li>
      <li><strong>VERY IMPORTANT!</strong> When typing the contents of the <strong>Data Analysis Body text</strong> field, make sure that you <strong>do not enter line breaks within &quot;lines&quot;</strong>. In our description of the contents of that field, it is assumed that a &quot;<strong>line</strong>&quot; is a continuous string of characters and words, unbroken by line breaks. Of course, a longish line of text may get <em>wrapped</em> to several apparent lines, but it is still considered as a single &quot;line&quot;. </li>
      <li>Line 2 must be an empty line.</li>
      <li>Lines 3, 6, 9, 12, etc. contain a condition formula, which conditions the display of the message on the following lines (4, 7, 10,...). The condition formulas available to you are restricted to 2 variables ($totalscore and $totalscorepercent) and 4 comparison operators:
        <ol>
          <li> <strong>&gt;</strong> 	Greater than</li>
          <li><strong>&lt;</strong> 	Less than</li>
          <li><strong>&gt;=</strong> 	Greater than or equal</li>
          <li><strong>&lt;=</strong>  	Less than or equal to.</li>
        </ol>
      </li>
      <li>Please note that the condition in line 6 might equally have been entered as if ($totalscore <strong>&lt;= 60</strong> and $totalscore &gt; 50). We might also have used the $totalscorepercent variable in our conditions.</li>
      <li>You can only have one or 2 comparisons per formula. You must include the comparisons between a pair of brackets. Instead of the &quot;and&quot; connector you may use the &quot;&amp;&amp;&quot; connector. You may put space characters before and after the parentheses, the comparison operators as you wish. You must put spaces before and after the &quot;and&quot; connector, but spaces are not needed on either side of the &quot;&amp;&amp;&quot;connector. </li>
    </ol>
  </li>
  <li>When done, click <strong>Save settings</strong>. If you made one or more errors in your <strong>Data Analysis Body text</strong> field syntax, error messages will be displayed, preventing you to save your settings. Remember that in the error messages any reference to a <em>line number</em> refers to a continuous line, not the apparent lines displayed on the screen, depending on the width of your browser window. </li>
</ol>
<h4>Case study #2: </h4>
<h5>Sample questionnaire: <em>Multiple Intelligences Test</em></h5>
<ol>
  <li>Create questionnaire as usual.</li>
  <li>Go to the <strong>Advanced Settings</strong> tab. </li>
  <li>In Submission options go to <strong>Data Analysis</strong> and select <strong>Subscores</strong> from the dropdown list. Save settings.</li>
  <li>Start creating your questions. In the Add selected question type dropdown list you notice that the list of question types available has been reduced to 4 (as per Case study #1 above). <br />
    <table class="questiontable">
      <tr>
        <td width="119"><em>Question text </em></td>
        <td>Section 1 (Li)</td>
      </tr>
      <tr>
        <td valign="top"><em>Possible answers </em></td>
        <td>0=Mostly Disagree<br />
          1=Slightly Disagree<br />
          2=No Opinion<br />
          3=Slightly Agree<br />
          4=Mostly Agree<br />
          I find it easy to make up stories<br />
          When talking to someone, I tend to listen to the words they use not just what they mean<br />
          I enjoy cross words, word searches or other word puzzles<br />
          I am a convincing liar<br />
          I find it easy to remember quotes or phrases<br />
          At school one of may favourite subjects is / was English<br />
          I enjoy debates and discussions<br />
          I often talk to myself &ndash; out loud or in my head<br />
          When I am abroad, I find it easy to pick up the basics of another language<br />
        I find pleasure in reading</td>
      </tr>
    </table>
  </li>
  <li> In this example we are using the &quot;<strong>Rate <em>with named degrees </em> </strong>&quot; option of the &quot;Rate (scale 1..5)&quot; question type. The &quot;named&quot; degrees must be preceded by a &quot;value&quot; followed by the equal sign, and the list of named degrees must come first. After the list of named degrees you will write the list of &quot;subquestions&quot;. </li>
  <li>When done with questions creating, go again to the <strong>Advanced Settings</strong> tab to edit the <strong>Data Analysis Heading text</strong> and <strong>Body text</strong>. The Heading text will be displayed at the top of the respondent's responses. Enter a fairly brief descriptive heading there.</li>
  <li>The <strong>Data Analysis Body text</strong> field is where you will enter the various Calculations, Conditions and Messages to be displayed to the Respondent. You'll have to be very careful to follow the examples given in this Help file, otherwise you will get error messages or unwanted displays.</li>
  <li>In <em><strong>Subscores </strong></em><strong>Data Analysis</strong> mode you have to enter a calculation formula for <em>each</em> subscore section of your questionnaire analysis. </li>
  <li>Let's examine an example. 
    <table width="100%" height="210"  style="border:#999999 thin dashed; margin-top:5px; margin-bottom:5px;">
      <tr>
        <td valign="top">line</td>
        <td valign="top">&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">1</td>
        <td>$subscore=$q1.1+$q1.2+$q1.3+$q1.4+$q1.5+$q1.6+$q1.7+$q1.8+$q1.9+$q1.10</td>
      </tr>
      <tr>
        <td valign="top">2</td>
        <td>Your Linguistic score is $subscorepercent%</td>
      </tr>
      <tr>
        <td valign="top">3</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">4</td>
        <td>if ( $subscorepercent &gt;= 50)</td>
      </tr>
      <tr>
        <td valign="top">5</td>
        <td>Learning style: you are at ease with words and language.</td>
      </tr>
      <tr>
        <td valign="top">6</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">7</td>
        <td>if ( $subscorepercent &lt; 50)</td>
      </tr>
      <tr>
        <td valign="top">8</td>
        <td>Learning style: you are probably not at ease with words and language.</td>
      </tr>
      <tr>
        <td valign="top">9</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">10</td>
        <td>$subscore=$q2.1+$q2.2+$q2.3+$q2.4+$q2.5+$q2.6+$q2.7+$q2.8+$q2.9+$q2.10</td>
      </tr>
      <tr>
        <td valign="top">11</td>
        <td>Your Logical-Mathematical score is $subscorepercent%</td>
      </tr>
      <tr>
        <td valign="top">12</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">13</td>
        <td>if ( $subscorepercent &gt;= 50)</td>
      </tr>
      <tr>
        <td valign="top">14</td>
        <td>Learning style: you are at ease with numbers and logic.</td>
      </tr>
      <tr>
        <td valign="top">15</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">16</td>
        <td>if ( $subscorepercent &lt; 50)</td>
      </tr>
      <tr>
        <td valign="top">17</td>
        <td>Learning style: you are probably not at ease with numbers and logic.</td>
      </tr>
      <tr>
        <td valign="top">&nbsp;</td>
        <td>&nbsp;</td>
      </tr>
      <tr>
        <td valign="top">&nbsp;</td>
        <td>etc.</td>
      </tr>
    </table>
  </li>
  <li>Lines 1, 10, etc. contain a simple addition of all the questions (or subquestions) that will make up a total subscore of the choices made by the respondent. The syntax uses a $subscore variable. The questions are identified by $q immediately followed their question number in the questionnaire (as displayed when the questionnaire is viewed). According to the question type and options, there are different ways to identify the questions or subquestions and their values.
    <ol style="list-style:lower-alpha;">
      <li>For Radio buttons (or Dropdown boxes), simply enter the question number as $1, $2, etc.</li>
      <li>For   Rate (scale 1..5) questions there are 2 possibilities:
        <ol>
          <li>If a Rate question contains only one &quot;subquestion&quot; (as in Case Study #1 above) you do not need to enter the number of that unique subquestion (but you can). Thus you may write &quot;$subscore=$q1.1+$q2.1&quot; or simply &quot;$subscore=$q1+$q2&quot;.</li>
          <li>If a Rate question contains severeal &quot;subquestions&quot; (as in Case Study #2) you <em><strong>must</strong></em> enter the number of the subquestions, as in the example given above: &quot;$subscore=$q2.1+$q2.2+$q2.3+etc&quot;. Should you forget to do so, and write e.g. &quot;$subscore=$q1+$q2&quot; etc. an error message will remind you. </li>
        </ol>
      </li>
    </ol>
  </li>
  <li>The line immediately following a $subscore calculation contains a message pertaining to that subscore. You can use the following 3 variables in your messages: $subscore, $maxsubscore and $subscorepercent.    </li>
  <li>If you need to display messages conditioned by the value of a $subscore, you need to write conditions, as in the <em><strong>Total Score </strong></em><strong>Data Analysis</strong> mode above. The syntax rules are exactly the same, except that you will use the $subscore or $subscorepercent variables in your condition rules.</li>
  <li>When done, click <strong>Save settings</strong>.</li>
  <li><strong>Note.-</strong> For the sake of convenience, in our <em>Multiple Intelligences Test</em> sample test, we have put all the sub-questions concerning a particular type of intelligence inside a unique Rate question. This makes it quite easy to then write the subscore addition in the <em><strong>Score </strong></em><strong>Data Analysis</strong> field. But a common strategy with this kind of &quot;personality test&quot; questionnaires is to <em>mix all questions</em> so that the respondent will not &quot;guess&quot; what kind of trait they are being tested on.</li>
</ol>
<h4>Using the Osgood type of rate scale</h4>
<p>When using the Rate (scale 1..5) question type, you may use the Osgood option. Here is an example.</p>
<table class="questiontable">
  <tr>
    <td>Type of rate scale </td>
    <td width="550">Osgood</td>
  </tr>
  <tr>
    <td width="161"><em>Question text </em></td>
    <td><p>Hard work doesn't pay.  </p></td>
  </tr>
  <tr>
    <td valign="top"><em>Possible answers </em></td>
    <td>0=--<br />
      1=-<br />
      2=&plusmn;<br />
      3=+<br />
      4=++<br />
    Totally disagree|Totally agree</td>
  </tr>
</table>
<div class="questiontable">
  <p>Will look like this in Questionnaire view:</p>
  <div>
    <p>Q1.- Hard work doesn't pay.</p>
    </div>
  <table border="0" cellpadding="0" cellspacing="1">
    <tbody>
      <tr>
        <td></td>
        <td>&nbsp;--&nbsp;</td>
        <td>&nbsp;-&nbsp;</td>
        <td>&nbsp;&plusmn;&nbsp;</td>
        <td>&nbsp;+&nbsp;</td>
        <td>&nbsp;++&nbsp;</td>
		        <td>&nbsp;</td>
      </tr>
      <tr>
        <td>Totally disagree&nbsp;</td>
        <td><input type="radio" /></td>
  <td><input type="radio" /></td>
  <td><input type="radio" /></td>
  <td><input type="radio" /></td>
  <td><input type="radio" /></td>        <td>&nbsp;Totally agree</td>
      </tr>
    </tbody>
    </table>
</div>
<p>If the respondent selects the <span class="Style1">--</span> column, that question will be worth a "score" of 0, the <span class="Style1">-</span> column choice will be worth 1 point, etc. </p>
<h4>Display of Data Analysis  results (&quot;scores&quot; and messages)</h4>
<p>When a questionnaire has been set to either <em><strong>Total Score </strong></em><strong>Data Analysis</strong> or <em><strong>SubScores </strong></em><strong>Data Analysis</strong> mode, the various &quot;scores&quot; and messages will be displayed in two different places.</p>
<ul>
  <li>When the respondent has finished and submitted his responses, the  various &quot;scores&quot; and messages will be displayed immediately upon clicking the Submit button.</li>
  <li>Then, any role that has the <em>View complete individual responses</em> capability will be able to view those &quot;scores&quot; and messages when viewing the  View By Response tab in the Questionnaire View All Responses tab. </li>
</ul>
<h4>Disclaimer</h4>
<p>The sample questionnaires using the Data Analysis feature on my Moodle test site are meant to be used solely as a way to understand the functioning of that feature. They have strictly no scientific value, and I invite you to refer to the various sites linked in their Summary for further information.</p>
<p>The Data Analysis feature presented here is only a proof-of-concept and in no way guarantees that it will be made available sooner or later in the official distribution of the Questionnaire module. </p>
<p>Joseph R&eacute;zeau - co-maintainer of the Moodle Questionnaire module. </p>
<p><a href="mailto:moodle@rezeau.org?subject=Questionnaire module::Data Analysis feature">moodle@rezeau.org </a></p>
<p>
  <!-- #BeginDate format:En2 -->07-Ao&ucirc;-2012<!-- #EndDate -->
</p>
</body>
</html>
